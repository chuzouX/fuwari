import{o as le,i as se,I as D,b as Y,r as z,h as ie,e as oe}from"./Icon.CVUYM8AL.js";import{n as ce,o as $,q as ue,g as m,i as fe,H as de,u as G,v as J,w as V,x as q,y as ve,z as ee,A as te,B as he,I as F,C as ae,D as K,E as pe,m as O,F as Q,G as ge,J as xe,K as be,L as me,M as _e,N as we,O as ye,P as ke,Q as Ee,p as Ce,l as U,a as Se,t as re,k as Ie,e as X,c as W,d as Le,h as L,f as T,r as A,s as H,b as Te,j as Z}from"./render.D4aKwFGu.js";import{u as Ae}from"./url-utils.uEDIkcjJ.js";/* empty css                        */function Me(u,e){return e}function Ne(u,e,t,c){for(var d=[],h=e.length,v=0;v<h;v++)be(e[v].e,d,!0);var b=h>0&&d.length===0&&t!==null;if(b){var p=t.parentNode;me(p),p.append(t),c.clear(),M(u,e[0].prev,e[h-1].next)}_e(d,()=>{for(var _=0;_<h;_++){var a=e[_];b||(c.delete(a.k),M(u,a.prev,a.next)),we(a.e,!b)}})}function Re(u,e,t,c,d,h=null){var v=u,b={flags:e,items:new Map,first:null};$&&ue();var p=null,_=!1,a=fe(()=>{var o=t();return ge(o)?o:o==null?[]:ae(o)});ce(()=>{var o=m(a),r=o.length;if(_&&r===0)return;_=r===0;let f=!1;if($){var s=v.data===de;s!==(r===0)&&(v=G(),J(v),V(!1),f=!0)}if($){for(var I=null,k,n=0;n<r;n++){if(q.nodeType===8&&q.data===ve){v=q,f=!0,V(!1);break}var w=o[n],N=c(w,n);k=ne(q,b,I,null,w,N,n,d,e,t),b.items.set(N,k),I=k}r>0&&J(G())}$||$e(o,b,v,d,e,c,t),h!==null&&(r===0?p?ee(p):p=te(()=>h(v)):p!==null&&he(p,()=>{p=null})),f&&V(!0),m(a)}),$&&(v=q)}function $e(u,e,t,c,d,h,v){var b=u.length,p=e.items,_=e.first,a=_,o,r=null,f=[],s=[],I,k,n,w;for(w=0;w<b;w+=1){if(I=u[w],k=h(I,w),n=p.get(k),n===void 0){var N=a?a.e.nodes_start:t;r=ne(N,e,r,r===null?e.first:r.next,I,k,w,c,d,v),p.set(k,r),f=[],s=[],a=r.next;continue}if(Pe(n,I,w),(n.e.f&F)!==0&&ee(n.e),n!==a){if(o!==void 0&&o.has(n)){if(f.length<s.length){var R=s[0],l;r=R.prev;var x=f[0],g=f[f.length-1];for(l=0;l<f.length;l+=1)j(f[l],R,t);for(l=0;l<s.length;l+=1)o.delete(s[l]);M(e,x.prev,g.next),M(e,r,x),M(e,g,R),a=R,r=g,w-=1,f=[],s=[]}else o.delete(n),j(n,a,t),M(e,n.prev,n.next),M(e,n,r===null?e.first:r.next),M(e,r,n),r=n;continue}for(f=[],s=[];a!==null&&a.k!==k;)(a.e.f&F)===0&&(o??=new Set).add(a),s.push(a),a=a.next;if(a===null)continue;n=a}f.push(n),r=n,a=n.next}if(a!==null||o!==void 0){for(var i=o===void 0?[]:ae(o);a!==null;)(a.e.f&F)===0&&i.push(a),a=a.next;var E=i.length;if(E>0){var y=null;Ne(e,i,y,p)}}K.first=e.first&&e.first.e,K.last=r&&r.e}function Pe(u,e,t,c){pe(u.v,e),u.i=t}function ne(u,e,t,c,d,h,v,b,p,_){var a=(p&ye)!==0,o=(p&ke)===0,r=a?o?O(d):Q(d):d,f=(p&xe)===0?v:Q(v),s={i:f,v:r,k:h,a:null,e:null,prev:t,next:c};try{return s.e=te(()=>b(u,r,f,_),$),s.e.prev=t&&t.e,s.e.next=c&&c.e,t===null?e.first=s:(t.next=s,t.e.next=s.e),c!==null&&(c.prev=s,c.e.prev=s.e),s}finally{}}function j(u,e,t){for(var c=u.next?u.next.e.nodes_start:t,d=e?e.e.nodes_start:t,h=u.e.nodes_start;h!==c;){var v=Ee(h);d.before(h),h=v}}function M(u,e,t){e===null?u.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}var qe=re(`<a class="transition first-of-type:mt-2 lg:first-of-type:mt-0 group block
       rounded-xl text-lg px-3 py-2 hover:bg-[var(--btn-plain-bg-hover)] active:bg-[var(--btn-plain-bg-active)]"><div class="transition text-90 inline-flex font-bold group-hover:text-[var(--primary)]"> <!></div> <div class="transition text-xs text-black/50 dark:text-white/50 mb-1 font-mono"> </div> <div class="transition text-sm text-50"><!></div></a>`),He=re(`<div id="search-bar" class="hidden lg:flex transition-all items-center h-11 mr-2 rounded-lg
      bg-black/[0.04] hover:bg-black/[0.06] focus-within:bg-black/[0.06]
      dark:bg-white/5 dark:hover:bg-white/10 dark:focus-within:bg-white/10
"><!> <input placeholder="搜索" class="transition-all pl-10 text-sm bg-transparent outline-0
         h-full w-40 active:w-60 focus:w-60 text-black/50 dark:text-white/50 svelte-1jbkgyt"></div> <button aria-label="Search Panel" id="search-switch" class="btn-plain scale-animation lg:!hidden rounded-lg w-11 h-11 active:scale-90"><!></button> <div id="search-panel" class="float-panel float-panel-closed search-panel absolute md:w-[30rem]
top-20 left-4 md:left-[unset] right-4 shadow-2xl rounded-2xl p-2 svelte-1jbkgyt"><div id="search-bar-inside" class="flex relative lg:hidden transition-all items-center h-11 rounded-xl
      bg-black/[0.04] hover:bg-black/[0.06] focus-within:bg-black/[0.06]
      dark:bg-white/5 dark:hover:bg-white/10 dark:focus-within:bg-white/10
  "><!> <input placeholder="Search" class="pl-10 absolute inset-0 text-sm bg-transparent outline-0
               focus:w-60 text-black/50 dark:text-white/50 svelte-1jbkgyt"></div> <!></div>`,1);function Fe(u,e){Ce(e,!1);let t=O(""),c=O(""),d=O([]),h=[];const v=()=>{document.getElementById("search-panel")?.classList.toggle("float-panel-closed")},b=(l,x)=>{const g=document.getElementById("search-panel");!g||!x||(l?g.classList.remove("float-panel-closed"):g.classList.add("float-panel-closed"))},p=(l,x)=>{if(!x)return l;const g=new RegExp(`(${x})`,"gi");return l.replace(g,"<mark>$1</mark>")},_=async(l,x)=>{if(!l){b(!1,x),H(d,[]);return}try{const g=h.filter(i=>{const E=l.toLowerCase(),y=`${i.title} ${i.description} ${i.content}`.toLowerCase(),C=`/posts/${i.link}`;return y.includes(E)||C.toLowerCase().includes(E)||i.link.toLowerCase().includes(E)}).map(i=>{const E=i.content.toLowerCase(),y=l.toLowerCase(),C=E.indexOf(y);let S="";if(C!==-1){const P=Math.max(0,C-50),B=Math.min(i.content.length,C+100);S=i.content.substring(P,B),P>0&&(S="..."+S),B<i.content.length&&(S=S+"...")}else S=i.description||i.content.substring(0,150)+"...";return{url:Ae(`/posts/${i.link}/`),meta:{title:i.title},excerpt:p(S,l),urlPath:`/posts/${i.link}`}});H(d,g),b(m(d).length>0,x)}catch(g){console.error("Search error:",g),H(d,[]),b(!1,x)}finally{}};le(async()=>{try{const x=await(await fetch("/rss.xml")).text(),E=new DOMParser().parseFromString(x,"text/xml").querySelectorAll("item");h=Array.from(E).map(y=>{let C="";const S=y.getElementsByTagNameNS("*","encoded")[0]?.textContent||y.querySelector("*|encoded")?.textContent||"";return S&&(C=S.replace(/<[^>]*>/g,"")),{title:y.querySelector("title")?.textContent||"",description:y.querySelector("description")?.textContent||"",content:C,link:y.querySelector("link")?.textContent?.replace(/.*\/posts\/(.*?)\//,"$1")||""}})}catch(l){console.error("Error fetching RSS:",l)}}),U(()=>m(t),()=>{_(m(t),!0)}),U(()=>m(c),()=>{_(m(c),!1)}),Se(),se();var a=He(),o=Ie(a),r=T(o);D(r,{icon:"material-symbols:search",class:"absolute text-[1.25rem] pointer-events-none ml-3 transition my-auto text-black/30 dark:text-white/30"});var f=L(r,2);z(f),A(o);var s=L(o,2),I=T(s);D(I,{icon:"material-symbols:search",class:"text-[1.25rem]"}),A(s);var k=L(s,2),n=T(k),w=T(n);D(w,{icon:"material-symbols:search",class:"absolute text-[1.25rem] pointer-events-none ml-3 transition my-auto text-black/30 dark:text-white/30"});var N=L(w,2);z(N),A(n);var R=L(n,2);Re(R,1,()=>m(d),Me,(l,x)=>{var g=qe(),i=T(g),E=T(i,!0),y=L(E);D(y,{icon:"fa6-solid:chevron-right",class:"transition text-[0.75rem] translate-x-1 my-auto text-[var(--primary)]"}),A(i);var C=L(i,2),S=T(C,!0);A(C);var P=L(C,2),B=T(P);ie(B,()=>m(x).excerpt),A(P),A(g),Te(()=>{oe(g,"href",m(x).url),Z(E,m(x).meta.title),Z(S,m(x).urlPath)}),W(l,g)}),A(k),Y(f,()=>m(t),l=>H(t,l)),X("focus",f,()=>_(m(t),!0)),X("click",s,v),Y(N,()=>m(c),l=>H(c,l)),W(u,a),Le()}export{Fe as default};
